# 作用域与执行上下文环境

除了全局作用域外，每个函数都会创建自己的作用域，即函数作用域

**作用域在函数定义的时候已经确定了**

**作用域只是一个"地盘"，一个抽象的概念，其中没有变量。要通过作用域对应的执行上下文环境来获取变量的值**

**同一个作用域下，不同的调用会产生不同的执行上下文环境，继而产生不同的变量值。所以，作用域中变量的值是在执行过程中确定的，而作用域却是在函数创建时就确定的**

所以，**要找到某一个作用域下某个变量的值，就需要找到这个作用域对应的执行上下文环境，再在其中寻找变量**

## 作用域与上下文环境的区别

- 上下文环境：可以理解为一个看不见摸不着的对象(有若干个属性)，虽然看不见摸不着，但确实实实在在存在的，因为所有的变量都在里面存储着
- 作用域：作用域只是一个"地盘"，一个抽象的概念，其中没有变量。要通过作用域对应的执行上下文环境来获取变量的值
- 两者：**一个作用域下可能包含多个执行上下文环境，有可能从来没有过执行上下文环境(如函数没有被调用过)；有可能有过，函数调用完毕，上下文环境被毁，有可能同时存在一个或多个(闭包)**

## 闭包时的执行上下文

```js
function fn(x) {
  return function () {
    console.log(x);
  };
}
var f1 = fn(5);
var f2 = fn(10);
```

如上代码段，当 `fn(10)` 执行时，`fn(5)` 已执行完毕，但是 `fn(5)` 的执行上下文环境还在内存中，这时就会在同一作用域(这里是全局作用域)下存在两个上下文环境

## 参考

- [深入理解javascript原型和闭包（13）-【作用域】和【上下文环境】](https://www.cnblogs.com/wangfupeng1988/p/3991995.html)
- [深入理解javascript原型和闭包（14）——从【自由变量】到【作用域链】](https://www.cnblogs.com/wangfupeng1988/p/3992795.html)
